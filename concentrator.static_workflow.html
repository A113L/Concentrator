<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Concentrator v1.4.1 Workflow</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #111827; 
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
                max-height: 450px;
            }
        }
        .flow-card {
            background-color: #374151; 
            border-radius: 0.5rem;
            padding: 0.75rem 1.25rem;
            text-align: center;
            font-weight: 700;
            color: #F3F4F6;
            border: 1px solid #4B5563;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
        }
        .flow-arrow {
            color: #00B7FF; 
            font-size: 2.5rem;
            font-weight: 900;
            margin: 0 0.5rem;
        }
        .flow-arrow-down {
            color: #00B7FF;
            font-size: 2.5rem;
            font-weight: 900;
            margin: 0.5rem 0;
        }
    </style>
</head>
<body class="text-gray-100">

    <header class="text-center p-8 md:p-12">
        <h1 class="text-4xl md:text-5xl font-black text-white mb-4">Concentrator v1.4.1</h1>
        <p class="text-xl md:text-2xl text-gray-300 max-w-4xl mx-auto">An interactive breakdown of how <span style="color: #00B7FF;">Concentrator</span> analyzes, models, and generates complex Hashcat rule sets.</p>
    </header>

    <main class="max-w-7xl mx-auto p-4 md:p-8">

        <section class="bg-gray-800 rounded-lg shadow-2xl p-6 md:p-10 my-8">
            <h2 class="text-3xl font-bold text-white mb-4">Phase 1: Data Ingestion & Parallel Analysis</h2>
            <p class="text-lg text-gray-300 mb-8 max-w-4xl">The first phase efficiently collects and processes all input rule files. It uses multiprocessing to analyze files in parallel, calculating rule and operator frequencies while filtering by max length.</p>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-10 items-center">
                <div class="flex flex-col items-center p-4">
                    <div class="flow-card w-full max-w-md">Input File/Directory Paths</div>
                    <div class="flow-arrow-down">â†“</div>
                    <div class="flow-card w-full max-w-md">Recursive File Collection</div>
                    <div class="flow-arrow-down">â†“</div>
                    <div class="flow-card w-full max-w-md" style="background-color: #0047FF;">Parallel Workers (Multi-Core)</div>
                    
                    <div class="flex flex-col md:flex-row justify-around w-full max-w-md mt-6">
                        <div class="flex flex-col items-center m-2">
                            <div class="flow-arrow-down">â†“</div>
                            <div class="flow-card" style="border-color: #00B7FF;">Rule Frequencies</div>
                        </div>
                        <div class="flex flex-col items-center m-2">
                            <div class="flow-arrow-down">â†“</div>
                            <div class="flow-card" style="border-color: #00B7FF;">Operator Frequencies</div>
                        </div>
                    </div>
                </div>

                <div>
                    <h4 class="text-xl font-bold text-white text-center mb-4">Analysis Output: Top 10 Operators</h4>
                    <p class="text-gray-400 text-center mb-4">Parallel analysis identifies the most common operators, which are key inputs for generation modes.</p>
                    <div class="chart-container">
                        <canvas id="operatorBarChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <section class="bg-gray-800 rounded-lg shadow-2xl p-6 md:p-10 my-8">
            <h2 class="text-3xl font-bold text-white mb-4">Phase 2: Data Consolidation & Modeling</h2>
            <p class="text-lg text-gray-300 mb-8 max-w-4xl">All processed data is merged into memory. This consolidated data is used to build a powerful Markov Model, creating a statistical "brain" that understands the probability of rule sequences.</p>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-10 items-center">
                <div class="flex flex-col justify-center items-center space-y-8 p-4">
                    <div class="text-center">
                        <div class="text-6xl font-black" style="color: #00FF7F;">1,845,209</div>
                        <div class="text-xl text-gray-300 mt-2">Total Unique Rules Analyzed</div>
                    </div>
                    <div class="text-center">
                        <div class="text-6xl font-black" style="color: #00FF7F;">5,230,112</div>
                        <div class="text-xl text-gray-300 mt-2">Markov Transitions Modeled</div>
                    </div>
                </div>

                <div class="flex flex-col items-center p-4">
                    <div class="flow-card w-full max-w-md">RAM or Temp Files</div>
                    <div class="flow-arrow-down">â†“</div>
                    <div class="flow-card w-full max-w-md">Merge & Consolidate All Rules</div>
                    <div class="flow-arrow-down">â†“</div>
                    <div class="flow-card w-full max-w-md" style="border-color: #00FF7F;">Full Rule Frequencies</div>
                    <div class="flow-arrow-down">â†“</div>
                    <div class="flow-card w-full max-w-md" style="background-color: #0047FF;">Build Markov Model (Bigrams/Trigrams)</div>
                </div>
            </div>
        </section>

        <section class="bg-gray-800 rounded-lg shadow-2xl p-6 md:p-10 my-8">
            <h2 class="text-3xl font-bold text-white mb-4">Phase 3: Primary Output - Rule Extraction</h2>
            <p class="text-lg text-gray-300 mb-8 max-w-4xl">This is the primary output mode. The script extracts the most valuable existing rules, allowing you to sort them by simple popularity or by their statistical probability.</p>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-10">
                <div class="bg-gray-700 p-6 rounded-lg shadow-lg">
                    <span class="text-5xl" role="img" aria-label="numbers">ðŸ”¢</span>
                    <h3 class="text-2xl font-bold text-white mt-4 mb-2">Frequency Sort (Raw Count)</h3>
                    <p class="text-gray-300">Sorts rules by most common. This is a simple, fast, and effective way to find widely-used rules.</p>
                </div>
                <div class="bg-gray-700 p-6 rounded-lg shadow-lg">
                    <span class="text-5xl" role="img" aria-label="brain">ðŸ§ </span>
                    <h3 class="text-2xl font-bold text-white mt-4 mb-2">Statistical Sort (Markov Weight)</h3>
                    <p class="text-gray-300">Sorts rules by a log-probability score. This identifies *statistically probable* chains, surfacing complex and effective rules that may not be the most common.</p>
                </div>
            </div>

            <h4 class="text-xl font-bold text-white text-center mb-4">Ranking Comparison: Statistical vs. Frequency</h4>
            <p class="text-gray-400 text-center mb-4">This chart shows how a rule's rank can differ dramatically between the two sorting methods. Rules highly-ranked by the Markov model (blue) are often buried deep in the frequency-ranked list (green).</p>
            <div class="chart-container">
                <canvas id="rankComparisonChart"></canvas>
            </div>
        </section>

        <section class="bg-gray-800 rounded-lg shadow-2xl p-6 md:p-10 my-8">
            <h2 class="text-3xl font-bold text-white mb-4">Phase 4: Optional - Rule Generation</h2>
            <p class="text-lg text-gray-300 mb-8 max-w-4xl">Instead of just extracting rules, Concentrator can create entirely new ones based on the analysis. It provides two methods, both of which are syntax-validated.</p>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-10">
                <div class="bg-gray-700 p-6 rounded-lg shadow-lg">
                    <span class="text-5xl" role="img" aria-label="shuffle">ðŸ”€</span>
                    <h3 class="text-2xl font-bold text-white mt-4 mb-2">Combinatorial Generation</h3>
                    <p class="text-gray-300">Generates all possible combinations from the Top K most frequent operators. This is a fast but "dumb" method that creates a high volume of rules.</p>
                </div>
                <div class="bg-gray-700 p-6 rounded-lg shadow-lg">
                    <span class="text-5xl" role="img" aria-label="dna">ðŸ§¬</span>
                    <h3 class="text-2xl font-bold text-white mt-4 mb-2">Markov Generation</h3>
                    <p class="text-gray-300">Traverses the Markov model to build *statistically likely* new rule chains. This "smart" method produces higher-quality, more effective rules.</p>
                </div>
            </div>

            <h4 class="text-xl font-bold text-white text-center mb-4">Generation Output (100k Target Sample)</h4>
            <p class="text-gray-400 text-center mb-4">Both methods run all generated rules through a syntax validator, filtering out invalid chains before saving the final set.</p>
            <div class="chart-container">
                <canvas id="generationChart"></canvas>
            </div>
        </section>

        <section class="bg-gray-800 rounded-lg shadow-2xl p-6 md:p-10 my-8">
            <h2 class="text-3xl font-bold text-white mb-4">Phase 5: Optional - External Cleanup</h2>
            <p class="text-lg text-gray-300 mb-8 max-w-4xl">The final, optional step. Even syntactically valid rules can be semantically redundant (e.g., `ll` or `[ ]`). This phase pipes an output file through an external cleanup binary to optimize the set.</p>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-10 items-center">
                <div class="flex flex-col items-center p-4">
                    <div class="flow-card w-full max-w-md">Primary Output File</div>
                    <div class="flow-arrow-down">â†“</div>
                    <div class="flow-card w-full max-w-md" style="background-color: #FF4E00;">External Cleanup Binary (-cb)</div>
                    <div class="flow-arrow-down">â†“</div>
                    <div class="flow-card w-full max-w-md" style="border-color: #00FF7F;">Final CLEANED Rule File</div>
                </div>

                <div>
                    <h4 class="text-xl font-bold text-white text-center mb-4">Cleanup Impact (Sample Top 10k File)</h4>
                    <p class="text-gray-400 text-center mb-4">The cleanup process removes inefficient or useless rules, shrinking the file size while preserving its effectiveness.</p>
                    <div class="chart-container">
                        <canvas id="cleanupPieChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <footer class="text-center p-8 text-gray-500">
        <p>Interactive Infographic created with Chart.js & Tailwind CSS.</p>
    </footer>

    <script>
        window.onload = function() {
            
            const chartColors = ['#00B7FF', '#00FF7F', '#FFB300', '#FF4E00', '#0047FF'];
            const gridColor = 'rgba(255, 255, 255, 0.1)';
            const textColor = '#E5E7EB';

            const wrapLabels = (label, maxChars = 16) => {
                if (typeof label !== 'string' || label.length <= maxChars) {
                    return label;
                }
                const words = label.split(' ');
                const lines = [];
                let currentLine = '';
                for (const word of words) {
                    if ((currentLine + ' ' + word).trim().length > maxChars) {
                        lines.push(currentLine.trim());
                        currentLine = word;
                    } else {
                        currentLine = (currentLine + ' ' + word).trim();
                    }
                }
                if (currentLine) {
                    lines.push(currentLine.trim());
                }
                return lines;
            };

            const tooltipTitleCallback = (tooltipItems) => {
                const item = tooltipItems[0];
                let label = item.chart.data.labels[item.dataIndex];
                if (Array.isArray(label)) {
                    return label.join(' ');
                } else {
                    return label;
                }
            };

            const commonChartOptions = {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        labels: {
                            color: textColor
                        }
                    },
                    tooltip: {
                        callbacks: {
                            title: tooltipTitleCallback
                        }
                    }
                },
                scales: {
                    x: {
                        ticks: { color: textColor },
                        grid: { color: gridColor }
                    },
                    y: {
                        ticks: { color: textColor },
                        grid: { color: gridColor }
                    }
                }
            };

            const operatorLabels = ['$', '^', 's', 'l', 'u', 'c', 't', '[', ']', 'd'];
            const operatorChartCtx = document.getElementById('operatorBarChart').getContext('2d');
            new Chart(operatorChartCtx, {
                type: 'bar',
                data: {
                    labels: operatorLabels,
                    datasets: [{
                        label: 'Frequency',
                        data: [550230, 520110, 480500, 300100, 290500, 280600, 250700, 200800, 190900, 150200],
                        backgroundColor: chartColors,
                        borderColor: '#1F2937',
                        borderWidth: 2
                    }]
                },
                options: { ...commonChartOptions }
            });

            const rankLabelsRaw = ['s.o$1', 'l t $1 $9', 'c $2 ^a ^b ^c', '[ d ]', 'r c $2'];
            const rankLabels = rankLabelsRaw.map(label => wrapLabels(label, 20)); 
            const rankComparisonCtx = document.getElementById('rankComparisonChart').getContext('2d');
            new Chart(rankComparisonCtx, {
                type: 'bar',
                data: {
                    labels: rankLabels,
                    datasets: [
                        {
                            label: 'Statistical Rank',
                            data: [1, 2, 3, 4, 5],
                            backgroundColor: chartColors[0], 
                            borderColor: '#1F2937',
                            borderWidth: 2
                        },
                        {
                            label: 'Frequency Rank',
                            data: [45, 120, 88, 230, 17],
                            backgroundColor: chartColors[1],
                            borderColor: '#1F2937',
                            borderWidth: 2
                        }
                    ]
                },
                options: {
                    ...commonChartOptions,
                    indexAxis: 'y', 
                    scales: {
                        x: {
                            ticks: { color: textColor },
                            grid: { color: gridColor },
                            title: {
                                display: true,
                                text: 'Rule Rank',
                                color: textColor
                            }
                        },
                        y: {
                            ticks: { color: textColor },
                            grid: { color: 'transparent' }
                        }
                    }
                }
            });

            const generationCtx = document.getElementById('generationChart').getContext('2d');
            new Chart(generationCtx, {
                type: 'bar',
                data: {
                    labels: ['Combinatorial', 'Markov'],
                    datasets: [{
                        label: 'Syntactically Valid Rules Generated',
                        data: [95230, 88410],
                        backgroundColor: [chartColors[2], chartColors[3]],
                        borderColor: '#1F2937',
                        borderWidth: 2
                    }]
                },
                options: {
                    ...commonChartOptions,
                    scales: {
                        x: {
                            ticks: { color: textColor },
                            grid: { color: 'transparent' }
                        },
                        y: {
                            ticks: { color: textColor },
                            grid: { color: gridColor }
                        }
                    }
                }
            });

            const cleanupPieCtx = document.getElementById('cleanupPieChart').getContext('2d');
            new Chart(cleanupPieCtx, {
                type: 'pie',
                data: {
                    labels: ['Rules Kept (Unique)', 'Rules Removed (Redundant)'],
                    datasets: [{
                        data: [7200, 2800],
                        backgroundColor: [chartColors[1], chartColors[3]],
                        borderColor: '#111827',
                        borderWidth: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: {
                                color: textColor
                            }
                        },
                        tooltip: {
                            callbacks: {
                                title: tooltipTitleCallback
                            }
                        }
                    }
                }
            });
        };
    </script>
</body>
</html>
